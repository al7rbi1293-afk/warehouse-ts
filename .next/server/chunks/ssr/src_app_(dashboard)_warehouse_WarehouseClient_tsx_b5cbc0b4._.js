module.exports=[51206,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(53995),e=a.i(23292),f=a.i(50944),g=a.i(38823);function h({warehouses:a}){let d=(0,f.useRouter)(),[h,i]=(0,c.useState)(!1),j=async a=>{a.preventDefault(),i(!0);let b=new FormData(a.currentTarget);try{let c=await (0,g.createInventoryItem)(b);c.success?(e.toast.success(c.message),d.refresh(),a.target.reset()):e.toast.error(c.message)}catch{e.toast.error("Failed to add item")}finally{i(!1)}};return(0,b.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Item Name (English)"}),(0,b.jsx)("input",{type:"text",name:"nameEn",required:!0,className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",placeholder:"e.g. Safety Helmet"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Item Name (Arabic)"}),(0,b.jsx)("input",{type:"text",name:"nameAr",className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-right",placeholder:"مثال: خوذة سلامة"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Category"}),(0,b.jsxs)("select",{name:"category",required:!0,className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",children:[(0,b.jsx)("option",{value:"",children:"Select Category"}),(0,b.jsx)("option",{value:"PPE",children:"PPE"}),(0,b.jsx)("option",{value:"Tools",children:"Tools"}),(0,b.jsx)("option",{value:"Electrical",children:"Electrical"}),(0,b.jsx)("option",{value:"Mechanical",children:"Mechanical"}),(0,b.jsx)("option",{value:"Consumables",children:"Consumables"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"SKU / Material Code"}),(0,b.jsx)("input",{type:"text",name:"materialCode",className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",placeholder:"e.g. MAT-001"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Initial Quantity"}),(0,b.jsx)("input",{type:"number",name:"qty",min:"0",required:!0,className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",placeholder:"0"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Unit"}),(0,b.jsxs)("select",{name:"unit",required:!0,className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",children:[(0,b.jsx)("option",{value:"PCS",children:"PCS"}),(0,b.jsx)("option",{value:"KG",children:"KG"}),(0,b.jsx)("option",{value:"BOX",children:"BOX"}),(0,b.jsx)("option",{value:"SET",children:"SET"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Warehouse Location"}),(0,b.jsxs)("select",{name:"location",required:!0,className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",children:[(0,b.jsx)("option",{value:"",children:"Select Warehouse"}),a.map(a=>(0,b.jsx)("option",{value:a.name,children:a.name},a.id))]})]})]}),(0,b.jsx)("div",{className:"flex justify-end pt-4",children:(0,b.jsx)("button",{type:"submit",disabled:h,className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg shadow-lg shadow-blue-500/30 transition-all disabled:opacity-70",children:h?"Adding Item...":"Add Item"})})]})}var i=a.i(5050);let j=(0,i.createServerReference)("008dbe8372055b3750585dba6abbc5b29108e97902",i.callServer,void 0,i.findSourceMapURL,"getProjects"),k=(0,i.createServerReference)("00908b79a68343eed8fc61d4495e0498b20734f9fb",i.callServer,void 0,i.findSourceMapURL,"getWarehouses");var l=a.i(63151),m=a.i(79459),n=a.i(48587);function o({inventory:a,userName:g,stockLogs:h}){let i=(0,f.useRouter)(),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)("transfer"),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)("NSTC"),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)([]);(0,c.useEffect)(()=>{(async()=>{let[a,b]=await Promise.all([j(),k()]);a.success&&a.data&&x(a.data),b.success&&b.data&&z(b.data)})()},[]);let A=async b=>{b.preventDefault(),p(!0);let c=new FormData(b.currentTarget),d=parseInt(s),f=c.get("fromLocation"),h="lend"===q?u:f,j=c.get("toLocation"),k=parseInt(c.get("qty")),o=c.get("notes"),r=a.find(a=>a.id===d),v=r?.unit||"PCS";try{let a;"transfer"===q?a=await (0,l.transferStock)(d,k,h,j,g,v,o):"lend"===q?a=await (0,m.lendStock)(d,k,j,g,v,o):"borrow"===q&&(a=await (0,n.returnStock)(d,k,h,j,g,v,o)),a?.success?(e.toast.success(a.message),i.refresh(),b.target.reset(),t("")):e.toast.error(a?.message||"Operation failed")}catch{e.toast.error("An unexpected error occurred")}finally{p(!1)}},B=h.filter(a=>a.actionType&&(a.actionType.includes("Transfer")||a.actionType.includes("Lent")||a.actionType.includes("Returned"))).slice(0,10),C=[{header:"Date",render:a=>a.logDate?new Date(a.logDate).toLocaleString():"-"},{header:"Item",accessorKey:"itemName"},{header:"Action",accessorKey:"actionType"},{header:"Change",render:a=>(0,b.jsxs)("span",{className:a.changeAmount&&a.changeAmount>0?"text-green-600 font-bold":"text-red-600 font-bold",children:[a.changeAmount&&a.changeAmount>0?"+":"",a.changeAmount," ",a.unit]})},{header:"Location",accessorKey:"location"},{header:"User",accessorKey:"actionBy"}];return(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("form",{onSubmit:A,className:"space-y-6",children:[(0,b.jsxs)("div",{className:"bg-blue-50/50 p-4 rounded-lg text-sm text-blue-700 border border-blue-100 mb-6 flex flex-col gap-2",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Order Execution:"})," These actions are executed immediately."]}),(0,b.jsxs)("ul",{className:"list-disc list-inside text-xs opacity-80",children:[(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Warehouse Transfer:"})," Move items between NSTC and SNC."]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Lend (Issue):"})," Issue items to a project (decreases stock)."]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Borrow (Return):"})," Return items from a project (increases stock)."]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-2 p-1 bg-slate-100 rounded-lg",children:[(0,b.jsx)("button",{type:"button",onClick:()=>r("transfer"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${"transfer"===q?"bg-white text-blue-600 shadow-sm":"text-slate-600 hover:text-slate-900"}`,children:"Warehouse Transfer"}),(0,b.jsx)("button",{type:"button",onClick:()=>r("lend"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${"lend"===q?"bg-white text-amber-600 shadow-sm":"text-slate-600 hover:text-slate-900"}`,children:"Lend (To Project)"}),(0,b.jsx)("button",{type:"button",onClick:()=>r("borrow"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${"borrow"===q?"bg-white text-green-600 shadow-sm":"text-slate-600 hover:text-slate-900"}`,children:"Borrow (From Project)"})]}),(0,b.jsx)("input",{type:"hidden",name:"transferType",value:q}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Select Item"}),(0,b.jsxs)("select",{name:"itemId",required:!0,value:s,onChange:a=>t(a.target.value),className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",children:[(0,b.jsx)("option",{value:"",children:"Select an item..."}),a.filter(a=>"lend"!==q||a.location===u).map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.nameEn," (",a.qty," ",a.unit," available at ",a.location,")"]},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"From Location"}),"transfer"===q&&(0,b.jsx)("select",{name:"fromLocation",className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 outline-none",children:y.length>0?y.map(a=>(0,b.jsxs)("option",{value:a.name,children:[a.name," Warehouse"]},a.id)):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("option",{value:"NSTC",children:"NSTC Warehouse"}),(0,b.jsx)("option",{value:"SNC",children:"SNC Warehouse"}),(0,b.jsx)("option",{value:"CWW",children:"CWW Warehouse"})]})}),"lend"===q&&(0,b.jsxs)("select",{name:"fromLocation",value:u,onChange:a=>{v(a.target.value),t("")},className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 outline-none",children:[(0,b.jsx)("option",{value:"NSTC",children:"NSTC Warehouse"}),(0,b.jsx)("option",{value:"SNC",children:"SNC Warehouse"}),(0,b.jsx)("option",{value:"CWW",children:"CWW Warehouse"})]}),"borrow"===q&&(0,b.jsxs)("select",{name:"fromLocation",required:!0,className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 outline-none",children:[(0,b.jsx)("option",{value:"",children:"Select Project..."}),w.map(a=>(0,b.jsx)("option",{value:a.name,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"To Location"}),"transfer"===q&&(0,b.jsx)("select",{name:"toLocation",className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 outline-none",children:y.length>0?y.map(a=>(0,b.jsxs)("option",{value:a.name,children:[a.name," Warehouse"]},a.id)):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("option",{value:"SNC",children:"SNC Warehouse"}),(0,b.jsx)("option",{value:"NSTC",children:"NSTC Warehouse"}),(0,b.jsx)("option",{value:"CWW",children:"CWW Warehouse"})]})}),"lend"===q&&(0,b.jsxs)("select",{name:"toLocation",required:!0,className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 outline-none",children:[(0,b.jsx)("option",{value:"",children:"Select Project..."}),w.map(a=>(0,b.jsx)("option",{value:a.name,children:a.name},a.id))]}),"borrow"===q&&(0,b.jsx)("select",{name:"toLocation",className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 outline-none",children:y.length>0?y.map(a=>(0,b.jsxs)("option",{value:a.name,children:[a.name," Warehouse"]},a.id)):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("option",{value:"NSTC",children:"NSTC Warehouse"}),(0,b.jsx)("option",{value:"SNC",children:"SNC Warehouse"}),(0,b.jsx)("option",{value:"CWW",children:"CWW Warehouse"})]})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Quantity"}),(0,b.jsx)("input",{type:"number",name:"qty",min:"1",required:!0,className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",placeholder:"0"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Reference / Notes"}),(0,b.jsx)("input",{type:"text",name:"notes",className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",placeholder:"Reason for transfer, PO number, etc..."})]})]}),(0,b.jsx)("div",{className:"flex justify-end pt-4",children:(0,b.jsx)("button",{type:"submit",disabled:o||!s,className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg shadow-lg shadow-blue-500/30 transition-all disabled:opacity-70 disabled:cursor-not-allowed flex items-center gap-2",children:o?(0,b.jsx)(b.Fragment,{children:"Processing..."}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,b.jsx)("path",{d:"M5 12h13M12 5l7 7-7 7"})}),"Execute Order"]})})})]}),(0,b.jsxs)("div",{className:"border-t border-slate-200 pt-8",children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-slate-800",children:"Recent Movements"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"History of transfers and project issues"})]}),(0,b.jsx)(d.PremiumTable,{columns:C,data:B})]})]})}var p=a.i(47260);function q({isOpen:a,onClose:d,item:g,userName:h}){let i=(0,f.useRouter)(),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)({nameEn:g.nameEn,category:g.category||"",qty:g.qty,unit:g.unit||"PCS"});if(!a)return null;let n=async a=>{a.preventDefault(),k(!0);try{let a=await (0,p.updateInventoryItem)(g.id,{nameEn:l.nameEn,category:l.category,qty:Number(l.qty),unit:l.unit},h);a.success?(e.toast.success(a.message),i.refresh(),d()):e.toast.error(a.message)}catch{e.toast.error("Failed to update item")}finally{k(!1)}};return(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200",children:[(0,b.jsxs)("div",{className:"px-6 py-4 border-b border-slate-100 flex justify-between items-center",children:[(0,b.jsx)("h3",{className:"font-bold text-lg text-slate-800",children:"Edit Inventory Item"}),(0,b.jsx)("button",{onClick:d,className:"text-slate-400 hover:text-slate-600 transition-colors",children:(0,b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,b.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,b.jsxs)("form",{onSubmit:n,className:"p-6 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Item Name"}),(0,b.jsx)("input",{type:"text",required:!0,value:l.nameEn,onChange:a=>m({...l,nameEn:a.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Category"}),(0,b.jsxs)("select",{required:!0,value:l.category,onChange:a=>m({...l,category:a.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",children:[(0,b.jsx)("option",{value:"",children:"Select Category"}),(0,b.jsx)("option",{value:"PPE",children:"PPE"}),(0,b.jsx)("option",{value:"Tools",children:"Tools"}),(0,b.jsx)("option",{value:"Electrical",children:"Electrical"}),(0,b.jsx)("option",{value:"Mechanical",children:"Mechanical"}),(0,b.jsx)("option",{value:"Consumables",children:"Consumables"}),!["PPE","Tools","Electrical","Mechanical","Consumables"].includes(l.category)&&l.category&&(0,b.jsx)("option",{value:l.category,children:l.category})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Quantity"}),(0,b.jsx)("input",{type:"number",required:!0,min:"0",value:l.qty,onChange:a=>m({...l,qty:Number(a.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Unit"}),(0,b.jsxs)("select",{required:!0,value:l.unit,onChange:a=>m({...l,unit:a.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",children:[(0,b.jsx)("option",{value:"PCS",children:"PCS"}),(0,b.jsx)("option",{value:"KG",children:"KG"}),(0,b.jsx)("option",{value:"BOX",children:"BOX"}),(0,b.jsx)("option",{value:"SET",children:"SET"})]})]})]}),(0,b.jsxs)("div",{className:"pt-4 flex justify-end gap-3",children:[(0,b.jsx)("button",{type:"button",onClick:d,className:"px-4 py-2 text-slate-600 hover:bg-slate-50 rounded-lg text-sm font-medium transition-colors",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:j,className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors disabled:opacity-50",children:j?"Saving...":"Save Changes"})]})]})]})})}var r=a.i(96461);function s({inventory:a,supervisorName:d,defaultRegion:g,regions:h}){let i=(0,f.useRouter)(),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)("All"),[p,q]=(0,c.useState)(g),[s,t]=(0,c.useState)({}),u=(0,c.useMemo)(()=>["All",...Array.from(new Set(a.map(a=>a.category||"Other")))],[a]),v=(0,c.useMemo)(()=>{let b=new Map;return a.forEach(a=>{if(!b.has(a.nameEn)){let c=a.nameEn.toLowerCase().includes(l.toLowerCase())||a.nameAr&&a.nameAr.includes(l),d="All"===n||a.category===n;c&&d&&b.set(a.nameEn,a)}}),Array.from(b.values())},[a,l,n]),w=async()=>{let b=Object.entries(s).map(([b,c])=>{let d=a.find(a=>a.nameEn===b);return{itemName:b,category:d?.category||"General",qty:c,unit:d?.unit||"PCS"}});if(0===b.length)return void e.toast.error("Please add at least one item to your request");k(!0);try{let a=await (0,r.createBulkRequest)(d,p,b);a.success?(e.toast.success(a.message),t({}),i.refresh()):e.toast.error(a.message)}catch{e.toast.error("Failed to submit request")}finally{k(!1)}},x=Object.keys(s).length;return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsx)("input",{type:"text",placeholder:"Search items...",value:l,onChange:a=>m(a.target.value),className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all"})}),(0,b.jsx)("div",{className:"md:w-48",children:(0,b.jsx)("select",{value:n,onChange:a=>o(a.target.value),className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",children:u.map(a=>(0,b.jsx)("option",{value:a,children:a},a))})}),(0,b.jsx)("div",{className:"md:w-48",children:(0,b.jsxs)("select",{value:p,onChange:a=>q(a.target.value),className:"w-full px-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all font-medium text-slate-700",children:[(0,b.jsx)("option",{value:"",children:"Select Region"}),h.map(a=>(0,b.jsx)("option",{value:a.name,children:a.name},a.id))]})})]}),(0,b.jsx)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden max-h-[600px] overflow-y-auto",children:(0,b.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,b.jsx)("thead",{className:"bg-[#F8FAFC] border-b border-slate-200 sticky top-0 z-10",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-4 font-semibold text-slate-600",children:"Item Name"}),(0,b.jsx)("th",{className:"px-6 py-4 font-semibold text-slate-600",children:"Category"}),(0,b.jsx)("th",{className:"px-6 py-4 font-semibold text-slate-600",children:"Unit"}),(0,b.jsx)("th",{className:"px-6 py-4 font-semibold text-slate-600 w-32",children:"Order Qty"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-slate-100",children:v.length>0?v.map(a=>{let c=s[a.nameEn]||"";return(0,b.jsxs)("tr",{className:`transition-colors ${c?"bg-blue-50/50":"hover:bg-slate-50/50"}`,children:[(0,b.jsx)("td",{className:"px-6 py-3 font-medium text-slate-900",children:a.nameEn}),(0,b.jsx)("td",{className:"px-6 py-3 text-slate-600",children:a.category}),(0,b.jsx)("td",{className:"px-6 py-3 text-slate-600",children:a.unit}),(0,b.jsx)("td",{className:"px-6 py-3",children:(0,b.jsx)("input",{type:"number",min:"0",placeholder:"0",value:c,onChange:b=>{var c;let d;return c=a.nameEn,d=parseInt(b.target.value),void t(a=>{let b={...a};return!isNaN(d)&&d>0?b[c]=d:delete b[c],b})},className:`w-full px-3 py-1.5 border rounded-md focus:ring-2 outline-none transition-all ${c?"border-blue-500 ring-2 ring-blue-500/20 bg-white":"border-slate-200 focus:border-blue-500 focus:ring-blue-500/20"}`})})]},a.nameEn)}):(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:4,className:"px-6 py-8 text-center text-slate-500",children:"No items found matching your filter."})})})]})}),(0,b.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-slate-100",children:[(0,b.jsxs)("div",{className:"text-sm font-medium text-slate-600",children:[(0,b.jsx)("span",{className:"text-slate-900 font-bold text-lg",children:x})," items selected"]}),(0,b.jsx)("button",{onClick:w,disabled:j||0===x,className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50 disabled:shadow-none",children:j?"Submitting...":"Submit Bulk Order"})]})]})}var t=a.i(14708);function u({isOpen:a,onClose:d,request:f}){let[g,h]=(0,c.useState)(f.qty||0),[i,j]=(0,c.useState)(f.notes||""),[k,l]=(0,c.useState)(!1);if(!a)return null;let m=async a=>{l(!0);try{let b=await (0,t.updateRequestStatus)(f.reqId,a,g,i);b.success?(e.toast.success(`Request ${a} successfully`),d()):e.toast.error(b.message)}catch{e.toast.error("Failed to process request")}finally{l(!1)}};return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 backdrop-blur-sm animate-fade-in",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden",children:[(0,b.jsxs)("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-slate-900",children:"Review Request"}),(0,b.jsx)("button",{onClick:d,className:"text-slate-400 hover:text-slate-500 transition-colors",children:(0,b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,b.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-4",children:[(0,b.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-slate-500",children:"Item:"}),(0,b.jsx)("span",{className:"font-medium text-slate-900",children:f.itemName})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-slate-500",children:"Category:"}),(0,b.jsx)("span",{className:"font-medium text-slate-900",children:f.category})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-slate-500",children:"Requester:"}),(0,b.jsx)("span",{className:"font-medium text-slate-900",children:f.supervisorName})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-slate-500",children:"Region:"}),(0,b.jsx)("span",{className:"font-medium text-slate-900",children:f.region})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-slate-500",children:"Original Qty:"}),(0,b.jsxs)("span",{className:"font-medium text-slate-900",children:[f.qty," ",f.unit]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Approved Quantity"}),(0,b.jsx)("input",{type:"number",min:"1",value:g,onChange:a=>h(parseInt(a.target.value)||0),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Notes (Optional)"}),(0,b.jsx)("textarea",{value:i,onChange:a=>j(a.target.value),placeholder:"Add reason for adjustment or rejection...",className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all h-24 resize-none"})]})]}),(0,b.jsxs)("div",{className:"p-6 border-t border-slate-100 flex justify-end gap-3 bg-slate-50",children:[(0,b.jsx)("button",{onClick:()=>m("Rejected"),disabled:k,className:"px-4 py-2 border border-red-200 text-red-600 rounded-lg hover:bg-red-50 font-medium transition-colors disabled:opacity-50",children:"Reject Request"}),(0,b.jsxs)("button",{onClick:()=>m("Approved"),disabled:k||g<=0,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors shadow-sm disabled:opacity-50",children:["Approve ",g," ",f.unit]})]})]})})}var v=a.i(37692);function w({isOpen:a,onClose:d,request:f,userName:g}){let[h,i]=(0,c.useState)(f.qty||0),[j,k]=(0,c.useState)(!1);if(!a)return null;let l=async()=>{k(!0);try{let a=await (0,v.bulkIssueRequests)(g,[{reqId:f.reqId,qty:h,itemName:f.itemName||"",region:f.region||"",unit:f.unit||""}]);a.success?(e.toast.success(a.message),d()):e.toast.error(a.message)}catch{e.toast.error("Failed to issue request")}finally{k(!1)}},m=async()=>{if(confirm("Are you sure you want to reject this request?")){k(!0);try{let a=await (0,t.updateRequestStatus)(f.reqId,"Rejected",void 0,"Rejected by Storekeeper");a.success?(e.toast.success("Request rejected"),d()):e.toast.error(a.message)}catch{e.toast.error("Failed to reject request")}finally{k(!1)}}};return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 backdrop-blur-sm animate-fade-in",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden",children:[(0,b.jsxs)("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-slate-900",children:"Issue Item"}),(0,b.jsx)("button",{onClick:d,className:"text-slate-400 hover:text-slate-500 transition-colors",children:(0,b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,b.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-4",children:[(0,b.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-slate-500",children:"Region:"}),(0,b.jsx)("span",{className:"font-medium text-slate-900",children:f.region})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-slate-500",children:"Item:"}),(0,b.jsx)("span",{className:"font-medium text-slate-900",children:f.itemName})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-slate-500",children:"Requested Qty:"}),(0,b.jsxs)("span",{className:"font-medium text-slate-900",children:[f.qty," ",f.unit]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Issue Quantity (Deduct from NSTC)"}),(0,b.jsx)("input",{type:"number",min:"1",value:h,onChange:a=>i(parseInt(a.target.value)||0),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all"})]}),(0,b.jsx)("p",{className:"text-xs text-orange-600 bg-orange-50 p-2 rounded border border-orange-100",children:"Warning: This will be deduced immediately from NSTC warehouse stock."})]}),(0,b.jsxs)("div",{className:"p-6 border-t border-slate-100 flex justify-end gap-3 bg-slate-50",children:[(0,b.jsx)("button",{onClick:m,disabled:j,className:"px-4 py-2 border border-red-200 text-red-600 rounded-lg hover:bg-red-50 font-medium transition-colors disabled:opacity-50",children:"Reject"}),(0,b.jsx)("button",{onClick:l,disabled:j||h<=0,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors shadow-sm disabled:opacity-50",children:"Confirm Issue"})]})]})})}var x=a.i(86731),y=a.i(46271),z=a.i(86723),A=a.i(74290),B=a.i(1703),C=a.i(14800),D=a.i(91128),E=c,F=a.i(65802);function G(a,b){if("function"==typeof a)return a(b);null!=a&&(a.current=b)}class H extends E.Component{getSnapshotBeforeUpdate(a){let b=this.props.childRef.current;if(b&&a.isPresent&&!this.props.isPresent){let a=b.offsetParent,c=(0,D.isHTMLElement)(a)&&a.offsetWidth||0,d=(0,D.isHTMLElement)(a)&&a.offsetHeight||0,e=this.props.sizeRef.current;e.height=b.offsetHeight||0,e.width=b.offsetWidth||0,e.top=b.offsetTop,e.left=b.offsetLeft,e.right=c-e.width-e.left,e.bottom=d-e.height-e.top}return null}componentDidUpdate(){}render(){return this.props.children}}function I({children:a,isPresent:d,anchorX:e,anchorY:f,root:g}){let h=(0,E.useId)(),i=(0,E.useRef)(null),j=(0,E.useRef)({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:k}=(0,E.useContext)(F.MotionConfigContext),l=function(...a){return c.useCallback(function(...a){return b=>{let c=!1,d=a.map(a=>{let d=G(a,b);return c||"function"!=typeof d||(c=!0),d});if(c)return()=>{for(let b=0;b<d.length;b++){let c=d[b];"function"==typeof c?c():G(a[b],null)}}}}(...a),a)}(i,a.props?.ref??a?.ref);return(0,E.useInsertionEffect)(()=>{let{width:a,height:b,top:c,left:l,right:m,bottom:n}=j.current;if(d||!i.current||!a||!b)return;let o="left"===e?`left: ${l}`:`right: ${m}`,p="bottom"===f?`bottom: ${n}`:`top: ${c}`;i.current.dataset.motionPopId=h;let q=document.createElement("style");k&&(q.nonce=k);let r=g??document.head;return r.appendChild(q),q.sheet&&q.sheet.insertRule(`
          [data-motion-pop-id="${h}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${b}px !important;
            ${o}px !important;
            ${p}px !important;
          }
        `),()=>{r.contains(q)&&r.removeChild(q)}},[d]),(0,b.jsx)(H,{isPresent:d,childRef:i,sizeRef:j,children:E.cloneElement(a,{ref:l})})}let J=({children:a,initial:d,isPresent:e,onExitComplete:f,custom:g,presenceAffectsLayout:h,mode:i,anchorX:j,anchorY:k,root:l})=>{let m=(0,A.useConstant)(K),n=(0,c.useId)(),o=!0,p=(0,c.useMemo)(()=>(o=!1,{id:n,initial:d,isPresent:e,custom:g,onExitComplete:a=>{for(let b of(m.set(a,!0),m.values()))if(!b)return;f&&f()},register:a=>(m.set(a,!1),()=>m.delete(a))}),[e,m,f]);return h&&o&&(p={...p}),(0,c.useMemo)(()=>{m.forEach((a,b)=>m.set(b,!1))},[e]),c.useEffect(()=>{e||m.size||!f||f()},[e]),"popLayout"===i&&(a=(0,b.jsx)(I,{isPresent:e,anchorX:j,anchorY:k,root:l,children:a})),(0,b.jsx)(C.PresenceContext.Provider,{value:p,children:a})};function K(){return new Map}var L=a.i(20410);let M=a=>a.key||"";function N(a){let b=[];return c.Children.forEach(a,a=>{(0,c.isValidElement)(a)&&b.push(a)}),b}let O=({children:a,custom:d,initial:e=!0,onExitComplete:f,presenceAffectsLayout:g=!0,mode:h="sync",propagate:i=!1,anchorX:j="left",anchorY:k="top",root:l})=>{let[m,n]=(0,L.usePresence)(i),o=(0,c.useMemo)(()=>N(a),[a]),p=i&&!m?[]:o.map(M),q=(0,c.useRef)(!0),r=(0,c.useRef)(o),s=(0,A.useConstant)(()=>new Map),t=(0,c.useRef)(new Set),[u,v]=(0,c.useState)(o),[w,x]=(0,c.useState)(o);(0,B.useIsomorphicLayoutEffect)(()=>{q.current=!1,r.current=o;for(let a=0;a<w.length;a++){let b=M(w[a]);p.includes(b)?(s.delete(b),t.current.delete(b)):!0!==s.get(b)&&s.set(b,!1)}},[w,p.length,p.join("-")]);let y=[];if(o!==u){let a=[...o];for(let b=0;b<w.length;b++){let c=w[b],d=M(c);p.includes(d)||(a.splice(b,0,c),y.push(c))}return"wait"===h&&y.length&&(a=y),x(N(a)),v(o),null}let{forceRender:C}=(0,c.useContext)(z.LayoutGroupContext);return(0,b.jsx)(b.Fragment,{children:w.map(a=>{let c=M(a),u=(!i||!!m)&&(o===w||p.includes(c));return(0,b.jsx)(J,{isPresent:u,initial:(!q.current||!!e)&&void 0,custom:d,presenceAffectsLayout:g,mode:h,root:l,onExitComplete:u?void 0:()=>{if(t.current.has(c)||(t.current.add(c),!s.has(c)))return;s.set(c,!0);let a=!0;s.forEach(b=>{b||(a=!1)}),a&&(C?.(),x(r.current),i&&n?.(),f&&f())},anchorX:j,anchorY:k,children:a},c)})})};function P({isOpen:a,onClose:d,request:f}){let[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)({itemName:f.itemName||"",category:f.category||"General",qty:f.qty?.toString()||"0",unit:f.unit||"Piece",notes:f.notes||""}),k=async a=>{a.preventDefault(),h(!0);try{let a=await (0,x.updateRequest)(f.reqId,{itemName:i.itemName,category:i.category,qty:parseFloat(i.qty),unit:i.unit,notes:i.notes});a.success?(e.toast.success(a.message),d()):e.toast.error(a.message)}catch{e.toast.error("An error occurred")}finally{h(!1)}};return(0,b.jsx)(O,{children:a&&(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:(0,b.jsxs)(y.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-xl shadow-xl w-full max-w-lg overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50",children:[(0,b.jsx)("h3",{className:"font-bold text-slate-800",children:"Edit Request"}),(0,b.jsx)("button",{onClick:d,className:"text-slate-400 hover:text-slate-600",children:(0,b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,b.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,b.jsxs)("form",{onSubmit:k,className:"p-6 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Item Name"}),(0,b.jsx)("input",{type:"text",required:!0,value:i.itemName,onChange:a=>j({...i,itemName:a.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Category"}),(0,b.jsxs)("select",{value:i.category,onChange:a=>j({...i,category:a.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",children:[(0,b.jsx)("option",{value:"General",children:"General"}),(0,b.jsx)("option",{value:"Chemicals",children:"Chemicals"}),(0,b.jsx)("option",{value:"Tools",children:"Tools"}),(0,b.jsx)("option",{value:"Safety",children:"Safety"}),(0,b.jsx)("option",{value:"Machines",children:"Machines"}),(0,b.jsx)("option",{value:"Consumables",children:"Consumables"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Unit"}),(0,b.jsxs)("select",{value:i.unit,onChange:a=>j({...i,unit:a.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",children:[(0,b.jsx)("option",{value:"Piece",children:"Piece"}),(0,b.jsx)("option",{value:"Box",children:"Box"}),(0,b.jsx)("option",{value:"Liter",children:"Liter"}),(0,b.jsx)("option",{value:"Kg",children:"Kg"}),(0,b.jsx)("option",{value:"Gallon",children:"Gallon"}),(0,b.jsx)("option",{value:"Pair",children:"Pair"}),(0,b.jsx)("option",{value:"Set",children:"Set"}),(0,b.jsx)("option",{value:"Roll",children:"Roll"}),(0,b.jsx)("option",{value:"Drum",children:"Drum"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Quantity"}),(0,b.jsx)("input",{type:"number",min:"1",step:"0.01",required:!0,value:i.qty,onChange:a=>j({...i,qty:a.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Notes (Optional)"}),(0,b.jsx)("textarea",{value:i.notes,onChange:a=>j({...i,notes:a.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none h-20 resize-none"})]}),(0,b.jsxs)("div",{className:"flex justify-end pt-4 gap-3",children:[(0,b.jsx)("button",{type:"button",onClick:d,className:"px-4 py-2 text-slate-700 hover:bg-slate-100 rounded-lg font-medium transition-colors",children:"Cancel"}),(0,b.jsxs)("button",{type:"submit",disabled:g,className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors shadow-sm disabled:opacity-70 flex items-center gap-2",children:[g&&(0,b.jsxs)("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,b.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,b.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Update Request"]})]})]})]})})})}var Q=a.i(19449),R=a.i(49324),S=a.i(24088),T=a.i(18006),U=a.i(33716);function V({data:g,userName:i,userRole:j="manager",userRegion:k="Riyadh"}){let l,m,n,p,r=(0,f.useRouter)(),[t,v]=(0,c.useState)("supervisor"===j?"my_requests":"storekeeper"===j?"requests":"stock"),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(g.warehouses[0]?.name||"NSTC"),[B,C]=(0,c.useState)("All"),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)({}),[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)("All"),[L,M]=(0,c.useState)(null),[N,O]=(0,c.useState)(!1),[V,W]=(0,c.useState)(null),[X,Y]=(0,c.useState)(!1),[Z,$]=(0,c.useState)(null),[_,aa]=(0,c.useState)(!1),[ab,ac]=(0,c.useState)(null),[ad,ae]=(0,c.useState)(!1),af=async a=>{try{let b=await (0,R.confirmReceipt)(a);b.success?(e.toast.success(b.message),r.refresh()):e.toast.error(b.message)}catch{e.toast.error("Failed to confirm receipt")}},ag=async()=>{if("All"===B)return void e.toast.error("Please select a specific region for stocktake");if(!confirm(`Submit stocktake for ${B}?`))return;let a=Object.entries(F).map(([a,b])=>({itemName:a,qty:b}));if(0===a.length)return void e.toast.info("No changes to submit");try{let b=await (0,S.bulkUpdateLocalInventory)(B,a,i);b.success?(e.toast.success(b.message),E(!1),G({}),r.refresh()):e.toast.error(b.message)}catch{e.toast.error("Failed to submit stocktake")}},ah=async a=>{if(confirm("Are you sure you want to delete this item?"))try{let b=await (0,Q.deleteInventoryItem)(a);b.success?(e.toast.success(b.message),r.refresh()):e.toast.error(b.message)}catch{e.toast.error("Failed to delete item")}},ai=g.inventory.filter(a=>a.location===z).filter(a=>a.nameEn.toLowerCase().includes(x.toLowerCase())||a.nameAr&&a.nameAr.includes(x)),aj=g.inventory,ak=[{header:"Item Name",accessorKey:"nameEn",render:a=>(0,b.jsx)("div",{children:(0,b.jsx)("div",{className:"font-medium text-slate-900",children:a.nameEn})})},{header:"Category",accessorKey:"category"},{header:"Quantity",accessorKey:"qty",render:a=>(0,b.jsxs)("span",{className:`font-bold ${a.qty<10?"text-red-500":"text-slate-700"}`,children:[a.qty," ",a.unit]})},{header:"Warehouse",render:()=>(0,b.jsx)("span",{className:"px-2 py-1 rounded-md bg-blue-50 text-blue-700 text-xs font-semibold",children:z})}],al=[{header:"Region",accessorKey:"region"},{header:"Item Details",render:a=>(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-bold text-slate-800",children:a.itemName}),(0,b.jsx)("div",{className:"text-xs text-slate-500",children:a.category})]})},{header:"Quantity",render:a=>(0,b.jsxs)("span",{className:"font-semibold text-slate-700",children:[a.qty," ",a.unit]})},{header:"Supervisor",accessorKey:"supervisorName"},{header:"Date",render:a=>a.requestDate?new Date(a.requestDate).toLocaleDateString():"-"},..."storekeeper"===j?[{header:"Approved By",render:a=>(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-medium text-slate-900",children:a.approvedBy||"-"}),a.approvedAt&&(0,b.jsx)("span",{className:"text-xs text-slate-500",children:new Date(a.approvedAt).toLocaleDateString()})]})}]:[],{header:"Status",render:a=>(0,b.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${"Pending"===a.status?"bg-yellow-100 text-yellow-800":"Approved"===a.status?"bg-green-100 text-green-800":"Issued"===a.status?"bg-blue-100 text-blue-800":"bg-slate-100 text-slate-800"}`,children:a.status})}],am=[{header:"Date",render:a=>a.logDate?new Date(a.logDate).toLocaleString():"-"},{header:"Item",accessorKey:"itemName"},{header:"Change",accessorKey:"changeAmount",render:a=>(0,b.jsxs)("span",{className:`font-semibold ${a.changeAmount&&a.changeAmount>0?"text-green-600":"text-red-600"}`,children:[a.changeAmount&&a.changeAmount>0?"+":"",a.changeAmount," ",a.unit]})},{header:"New Qty",accessorKey:"newQty"},{header:"Action",accessorKey:"actionType"},{header:"User",accessorKey:"actionBy"}],an=[{header:"Item Name",accessorKey:"itemName"},{header:"Quantity",accessorKey:"qty",render:a=>(0,b.jsx)("span",{className:"font-bold text-slate-700",children:a.qty})},{header:"Region",accessorKey:"region",render:a=>(0,b.jsx)("span",{className:"px-2 py-1 rounded-md bg-slate-100 text-slate-700 text-xs font-semibold",children:a.region})},{header:"Last Updated",render:a=>a.lastUpdated?new Date(a.lastUpdated).toLocaleDateString():"-"}],ao=k?k.split(",").map(a=>a.trim()):[],ap="supervisor"===j&&ao.length>0?g.regions.filter(a=>ao.includes(a.name)):g.regions,aq=g.localInventory.filter(a=>("supervisor"!==j||!!ao.includes(a.region))&&("All"===B||a.region===B)),ar="supervisor"===j?ao:g.regions.map(a=>a.name);return(0,b.jsxs)("div",{className:"space-y-6 animate-fade-in pb-12",children:[(0,b.jsx)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:"Inventory Management"}),(0,b.jsx)("p",{className:"text-slate-500 text-sm",children:"Manage stock, transfers, and warehouse operations"})]})}),(0,b.jsx)("div",{className:"bg-white p-1 rounded-xl border border-slate-200 inline-flex shadow-sm overflow-x-auto max-w-full",children:(l=[],"manager"===j?l=["stock","add","transfer","requests","tracking","approved","audit","regional_stock","logs"]:"storekeeper"===j?l=["requests","approved","stock"]:"supervisor"===j&&(l=["my_requests","rejected","new_request","local_stock"]),l.map(a=>(0,b.jsx)("button",{onClick:()=>v(a),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all whitespace-nowrap ${t===a?"bg-blue-600 text-white shadow-sm":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}`,children:a.split("_").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ")},a)))}),"add"===t&&(0,b.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"Add New Inventory Item"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Create a new item in the warehouse"})]}),(0,b.jsx)("div",{className:"card-premium p-6",children:(0,b.jsx)(h,{warehouses:g.warehouses})})]}),"requests"===t&&(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"storekeeper"===j?"Approved Requests":"Pending Requests"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"storekeeper"===j?"Requests waiting for issuance":"Requests requiring approval"})]}),(0,b.jsx)(U.ExportButton,{data:("storekeeper"===j?g.approvedRequests:g.pendingRequests).map(a=>({Region:a.region,Item:a.itemName,Quantity:a.qty,Unit:a.unit,Supervisor:a.supervisorName,Date:a.requestDate?new Date(a.requestDate).toLocaleDateString():"-",Status:a.status})),fileName:`${"storekeeper"===j?"Approved":"Pending"}_Requests_${new Date().toISOString().split("T")[0]}`})]}),(()=>{let c="storekeeper"===j?g.approvedRequests:g.pendingRequests;if(0===c.length)return(0,b.jsx)("div",{className:"text-center py-12 text-slate-500 bg-slate-50 rounded-xl border border-slate-100 italic",children:"storekeeper"===j?"No approved requests to issue":"No pending requests"});let f=c.reduce((a,b)=>{let c=b.region||"Unassigned";return a[c]||(a[c]=[]),a[c].push(b),a},{}),h=async(b,c)=>{if(confirm(`Approve all ${c.length} requests for ${b}?`))try{let b=c.map(a=>a.reqId),{bulkApproveRequests:d}=await a.A(37640),f=await d(b);f.success?(e.toast.success(f.message),r.refresh()):e.toast.error(f.message)}catch{e.toast.error("Failed to approve requests")}},k=async(b,c)=>{let d=prompt(`Reject all ${c.length} requests for ${b}? Enter reason:`);if(null!==d)try{let b=c.map(a=>a.reqId),{bulkRejectRequests:f}=await a.A(37640),g=await f(b,d||"No reason provided");g.success?(e.toast.success(g.message),r.refresh()):e.toast.error(g.message)}catch{e.toast.error("Failed to reject requests")}},l=async(b,c)=>{if(confirm(`Issue all ${c.length} requests for ${b}? This will deduct stock from NSTC.`))try{let d=c.map(a=>({reqId:a.reqId,qty:a.qty||0,itemName:a.itemName||"Unknown",region:b,unit:a.unit||"pcs"})),{bulkIssueRequests:f}=await a.A(37640),g=await f(i,d);g.success?(e.toast.success(g.message),r.refresh()):e.toast.error(g.message)}catch{e.toast.error("Failed to issue requests")}};return Object.entries(f).sort().map(([a,c])=>(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-6 py-4 bg-slate-50 border-b border-slate-200 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,b.jsxs)("h3",{className:"font-bold text-slate-800 flex items-center gap-2",children:[(0,b.jsx)("span",{className:`w-2 h-2 rounded-full ${"storekeeper"===j?"bg-green-500":"bg-yellow-400"}`}),a]}),(0,b.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,b.jsxs)("span",{className:"text-xs font-medium text-slate-500 bg-white px-2 py-1 rounded-full border border-slate-200 mr-2",children:[c.length," Requests"]}),"storekeeper"===j?(0,b.jsx)("button",{onClick:()=>l(a,c),className:"px-3 py-1.5 bg-blue-600 text-white rounded-md text-xs font-medium hover:bg-blue-700 transition-colors shadow-sm",children:"Issue All"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>k(a,c),className:"px-3 py-1.5 bg-white border border-red-200 text-red-600 rounded-md text-xs font-medium hover:bg-red-50 transition-colors shadow-sm",children:"Reject All"}),(0,b.jsx)("button",{onClick:()=>h(a,c),className:"px-3 py-1.5 bg-green-600 text-white rounded-md text-xs font-medium hover:bg-green-700 transition-colors shadow-sm",children:"Approve All"})]})]})]}),(0,b.jsx)(d.PremiumTable,{columns:al,data:c,actions:a=>"storekeeper"===j?(0,b.jsx)("button",{onClick:()=>{$(a),aa(!0)},className:"px-3 py-1 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 shadow-sm",children:"Issue"}):(0,b.jsx)("button",{onClick:()=>{W(a),Y(!0)},className:"px-3 py-1 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 shadow-sm",children:"Review"})})]},a))})()]}),"approved"===t&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"Approved Requests"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"History of approved supply requests"})]}),(0,b.jsx)(U.ExportButton,{data:g.approvedRequests.map(a=>({Region:a.region,Item:a.itemName,Quantity:a.qty,Unit:a.unit,Supervisor:a.supervisorName,Date:a.requestDate?new Date(a.requestDate).toLocaleDateString():"-",Approver:a.approvedBy||"-",Status:a.status})),fileName:`Approved_Requests_${new Date().toISOString().split("T")[0]}`})]}),0===g.approvedRequests.length?(0,b.jsx)("div",{className:"text-center py-12 text-slate-500 bg-slate-50 rounded-xl border border-slate-100 italic",children:"No approved requests found"}):(0,b.jsx)(d.PremiumTable,{columns:al,data:g.approvedRequests})]}),"tracking"===t&&(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"Request Tracking"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Lifecycle view of all requests"})]}),(0,b.jsx)(U.ExportButton,{data:(g.allRequests||[]).map(a=>({Region:a.region,Item:a.itemName,Quantity:a.qty,Unit:a.unit,Supervisor:a.supervisorName,Date:a.requestDate?new Date(a.requestDate).toLocaleDateString():"-",Status:a.status,Approver:a.approvedBy||"-",IssuedBy:a.issuedBy||"-",Notes:a.notes||"-"})),fileName:`Tracking_Requests_${new Date().toISOString().split("T")[0]}`})]}),g.allRequests&&0!==g.allRequests.length?Object.entries((g.allRequests||[]).reduce((a,b)=>{let c=b.region||"Unassigned";return a[c]||(a[c]=[]),a[c].push(b),a},{})).sort().map(([a,c])=>(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-6 py-3 bg-slate-50 border-b border-slate-200 flex justify-between items-center",children:[(0,b.jsxs)("h3",{className:"font-bold text-slate-800 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"w-2 h-2 rounded-full bg-blue-500"}),a]}),(0,b.jsxs)("span",{className:"text-xs font-medium text-slate-500 bg-white px-2 py-1 rounded-full border border-slate-200",children:[c.length," Requests"]})]}),(0,b.jsx)(d.PremiumTable,{columns:[...al,{header:"Approver",accessorKey:"approvedBy"},{header:"Issued By",accessorKey:"issuedBy"}],data:c})]},a)):(0,b.jsx)("div",{className:"text-center py-12 text-slate-500 bg-slate-50 rounded-xl border border-slate-100 italic",children:"No requests found"})]}),"rejected"===t&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-red-600",children:"Rejected Requests"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Requests rejected by management"})]})}),g.myRejectedRequests&&0!==g.myRejectedRequests.length?(0,b.jsx)(d.PremiumTable,{columns:[{header:"Item",accessorKey:"itemName"},{header:"Quantity",render:a=>(0,b.jsxs)("span",{className:"font-semibold text-slate-700",children:[a.qty," ",a.unit]})},{header:"Date",render:a=>a.requestDate?new Date(a.requestDate).toLocaleDateString():"-"},{header:"Reason",render:a=>(0,b.jsx)("div",{className:"text-red-600 font-medium bg-red-50 p-2 rounded-md border border-red-100 text-sm",children:a.notes||"No reason provided"})}],data:g.myRejectedRequests}):(0,b.jsx)("div",{className:"text-center py-12 text-slate-500 bg-slate-50 rounded-xl border border-slate-100 italic",children:"No rejected requests"})]}),"audit"===t&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"Audit Logs"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"System activities and tracked actions"})]}),(0,b.jsx)(U.ExportButton,{data:g.auditLogs.map(a=>({Date:new Date(a.timestamp).toLocaleString(),User:a.userName,Action:a.action,Module:a.module,Details:a.details})),fileName:`Audit_Logs_${new Date().toISOString().split("T")[0]}`})]}),(0,b.jsx)(d.PremiumTable,{columns:[{header:"Timestamp",render:a=>new Date(a.timestamp).toLocaleString()},{header:"User",accessorKey:"userName"},{header:"Action",accessorKey:"action"},{header:"Module",accessorKey:"module"},{header:"Details",accessorKey:"details"}],data:g.auditLogs})]}),"transfer"===t&&(0,b.jsx)(o,{inventory:aj,userName:i,stockLogs:g.stockLogs}),(0,b.jsxs)("div",{className:"card-premium p-6 min-h-[500px]",children:["stock"===t&&(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[(0,b.jsx)("div",{className:"relative flex-1",children:(0,b.jsx)("input",{type:"text",placeholder:"Search items by name...",value:x,onChange:a=>y(a.target.value),className:"w-full pl-4 pr-10 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})}),(0,b.jsx)("div",{className:"flex rounded-lg bg-slate-100 p-1",children:g.warehouses.length>0?g.warehouses.filter(a=>"CWW"!==a.name).map(a=>(0,b.jsxs)("button",{onClick:()=>A(a.name),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${z===a.name?"bg-white text-blue-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[a.name," Warehouse"]},a.id)):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>A("NSTC"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${"NSTC"===z?"bg-white text-blue-600 shadow-sm":"text-slate-500"}`,children:"NSTC Warehouse"}),(0,b.jsx)("button",{onClick:()=>A("SNC"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${"SNC"===z?"bg-white text-blue-600 shadow-sm":"text-slate-500"}`,children:"SNC Warehouse"})]})})]}),"stock"===t&&(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsx)(U.ExportButton,{data:ai.map(a=>({Name:a.nameEn,Category:a.category,Quantity:a.qty,Unit:a.unit,Warehouse:a.location,Status:a.status})),fileName:`Inventory_Stock_${new Date().toISOString().split("T")[0]}`})}),(()=>{if(0===ai.length)return(0,b.jsx)("div",{className:"text-center py-12 text-slate-500 bg-slate-50 rounded-xl border border-slate-100 italic",children:"No items found"});let a={};return ai.forEach(b=>{let c=b.category||"Uncategorized";a[c]||(a[c]=[]),a[c].push(b)}),Object.entries(a).sort().map(([a,c])=>(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-6 py-4 bg-slate-50 border-b border-slate-200 flex justify-between items-center",children:[(0,b.jsxs)("h3",{className:"font-bold text-slate-800 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"w-2 h-2 rounded-full bg-blue-500"}),a]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(U.ExportButton,{data:c.map(a=>({Name:a.nameEn,Category:a.category,Quantity:a.qty,Unit:a.unit,Location:a.location})),fileName:`${a}_Inventory`,label:"Export",className:"bg-slate-600 hover:bg-slate-700"}),(0,b.jsxs)("span",{className:"text-xs font-medium text-slate-500 bg-white px-2 py-1 rounded-full border border-slate-200 flex items-center",children:[c.length," Items"]})]})]}),(0,b.jsx)(d.PremiumTable,{columns:ak,data:c,actions:a=>(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>{M(a),O(!0)},className:"text-blue-600 hover:text-blue-800 font-medium text-sm",children:"Edit"}),(0,b.jsx)("button",{onClick:()=>ah(a.id),className:"text-red-600 hover:text-red-800 font-medium text-sm",children:"Delete"})]})})]},a))})()]}),"logs"===t&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"flex justify-end mb-4",children:(0,b.jsx)(U.ExportButton,{data:g.stockLogs.map(a=>({Date:a.logDate?new Date(a.logDate).toLocaleString():"-",Item:a.itemName,Change:a.changeAmount,NewQty:a.newQty,Action:a.actionType,User:a.actionBy,Location:a.location})),fileName:`Stock_Logs_${new Date().toISOString().split("T")[0]}`})}),(0,b.jsx)(d.PremiumTable,{columns:am,data:g.stockLogs})]}),"new_request"===t&&(0,b.jsxs)("div",{className:"max-w-3xl mx-auto py-4",children:[(0,b.jsxs)("div",{className:"mb-6 border-b border-slate-100 pb-4",children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"New Supply Request"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Request items for your region"})]}),(0,b.jsx)(s,{inventory:g.inventory,supervisorName:i,defaultRegion:k||"",regions:ap})]}),"my_requests"===t&&(0,b.jsxs)("div",{className:"space-y-8",children:[g.readyForPickup.length>0&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("h3",{className:"text-lg font-bold text-green-700 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"w-2 h-2 rounded-full bg-green-500"}),"Ready for Pickup"]}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Please collect these items and confirm receipt"})]}),(m=async(a,b)=>{if(confirm(`Confirm receipt for all ${b.length} items in ${a}?`))try{let a=b.map(a=>a.reqId),c=await (0,T.bulkConfirmReceipt)(a);c.success?(e.toast.success(c.message),r.refresh()):e.toast.error(c.message)}catch{e.toast.error("Failed to confirm receipts")}},Object.entries(g.readyForPickup.reduce((a,b)=>{let c=b.region||"Unassigned";return a[c]||(a[c]=[]),a[c].push(b),a},{})).sort().map(([a,c])=>(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-6 py-4 bg-slate-50 border-b border-slate-200 flex justify-between items-center",children:[(0,b.jsxs)("h3",{className:"font-bold text-slate-800 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"w-2 h-2 rounded-full bg-green-500"}),a]}),(0,b.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,b.jsxs)("span",{className:"text-xs font-medium text-slate-500 bg-white px-2 py-1 rounded-full border border-slate-200",children:[c.length," Items"]}),(0,b.jsx)("button",{onClick:()=>m(a,c),className:"text-xs bg-green-600 text-white px-3 py-1.5 rounded-md font-medium hover:bg-green-700 transition-colors shadow-sm",children:"Confirm All"})]})]}),(0,b.jsx)(d.PremiumTable,{columns:al,data:c,actions:a=>(0,b.jsx)("button",{onClick:()=>af(a.reqId),className:"px-3 py-1 bg-green-600 text-white rounded-md text-sm font-medium hover:bg-green-700 transition-colors shadow-sm",children:"Confirm Receipt"})})]},a)))]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)("h3",{className:"text-lg font-bold text-slate-700",children:"Pending Requests"})}),g.myPendingRequests&&0!==g.myPendingRequests.length?Object.entries(g.myPendingRequests.reduce((a,b)=>{let c=b.region||"Unassigned";return a[c]||(a[c]=[]),a[c].push(b),a},{})).sort().map(([a,c])=>(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden mb-4",children:[(0,b.jsxs)("div",{className:"px-6 py-3 bg-slate-50 border-b border-slate-200 flex justify-between items-center",children:[(0,b.jsxs)("h3",{className:"font-bold text-slate-700 flex items-center gap-2 text-sm",children:[(0,b.jsx)("span",{className:"w-2 h-2 rounded-full bg-yellow-400"}),a]}),(0,b.jsxs)("span",{className:"text-xs font-medium text-slate-500 bg-white px-2 py-1 rounded-full border border-slate-200",children:[c.length," Requests"]})]}),(0,b.jsx)(d.PremiumTable,{columns:al,data:c,actions:a=>(0,b.jsx)("button",{onClick:()=>{ac(a),ae(!0)},className:"px-3 py-1 text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-md text-xs font-medium transition-colors",children:"Edit"})})]},a)):(0,b.jsx)("div",{className:"text-center py-8 text-slate-500 bg-slate-50 rounded-lg border border-slate-100 italic",children:"No pending requests"})]})]}),"regional_stock"===t&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"Regional Stock Overview"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Inventory levels across all project regions"})]})}),0===g.localInventory.length?(0,b.jsx)("div",{className:"text-center py-12 text-slate-500 bg-slate-50 rounded-xl border border-slate-100 italic",children:"No regional stock data available"}):(n=g.localInventory.filter(a=>"supervisor"!==j||ao.includes(a.region)),p={},n.forEach(a=>{let b=a.region||"Unassigned";p[b]||(p[b]=[]),p[b].push(a)}),Object.entries(p).sort().map(([a,c])=>(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden mb-6",children:[(0,b.jsxs)("div",{className:"px-6 py-4 bg-slate-50 border-b border-slate-200 flex justify-between items-center",children:[(0,b.jsxs)("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"w-2.5 h-2.5 rounded-full bg-blue-600"}),a," Region"]}),(0,b.jsxs)("span",{className:"px-3 py-1 bg-white border border-slate-200 rounded-full text-xs font-medium text-slate-500",children:[c.reduce((a,b)=>a+(b.qty||0),0)," Total Items"]})]}),(0,b.jsx)(d.PremiumTable,{columns:an,data:c})]},a)))]}),"local_stock"===t&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"text-lg font-bold text-slate-900",children:["Local Stock - ","All"===B?"All Regions":B]}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Current inventory in your region"})]})}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)("button",{onClick:()=>C("All"),className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-all ${"All"===B?"bg-slate-800 text-white border-slate-800":"bg-white text-slate-600 border-slate-200 hover:border-slate-300"}`,children:"All"}),ar.map(a=>(0,b.jsx)("button",{onClick:()=>C(a),className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-all ${B===a?"bg-slate-800 text-white border-slate-800":"bg-white text-slate-600 border-slate-200 hover:border-slate-300"}`,children:a},a))]})]}),D?(0,b.jsxs)("div",{className:"bg-slate-50 p-6 rounded-xl border border-slate-200",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 mb-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"text-lg font-bold text-slate-800",children:["Stocktake: ",B]}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Enter current counts for all items."})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>E(!1),className:"px-4 py-2 bg-white border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 font-medium text-sm",children:"Cancel"}),(0,b.jsx)("button",{onClick:ag,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium text-sm shadow-sm",children:"Submit Stocktake"})]})]}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)("input",{type:"text",placeholder:"Search items...",value:H,onChange:a=>I(a.target.value),className:"flex-1 px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"}),(0,b.jsxs)("select",{value:J,onChange:a=>K(a.target.value),className:"px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",children:[(0,b.jsx)("option",{value:"All",children:"All Categories"}),Array.from(new Set(g.inventory.map(a=>a.category||"Uncategorized"))).sort().map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})]})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from(new Set(g.inventory.map(a=>a.nameEn))).filter(a=>{if(H&&!a.toLowerCase().includes(H.toLowerCase()))return!1;if("All"!==J){let b=g.inventory.find(b=>b.nameEn===a);if(b?.category!==J)return!1}return!0}).sort().map(a=>{let c=F[a]??0;return(0,b.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-slate-200 shadow-sm flex justify-between items-center",children:[(0,b.jsx)("span",{className:"font-medium text-slate-700 truncate mr-2",title:a,children:a}),(0,b.jsx)("input",{type:"number",min:"0",value:c,onChange:b=>{let c=parseInt(b.target.value)||0;G(b=>({...b,[a]:c}))},className:"w-24 px-3 py-1 border border-slate-200 rounded focus:ring-2 focus:ring-blue-500 outline-none text-right font-mono"})]},a)})})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"flex justify-end mb-4",children:(0,b.jsxs)("button",{onClick:()=>{if("All"===B)return void e.toast.error("Please select a specific region to start stocktake");let a={};g.localInventory.filter(a=>a.region===B).forEach(b=>{a[b.itemName]=b.qty??0}),G(a),E(!0)},disabled:"All"===B,className:`px-4 py-2 rounded-lg font-medium text-sm shadow-sm transition-all flex items-center gap-2 ${"All"===B?"bg-slate-100 text-slate-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:[(0,b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,b.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),"Manual Stocktake"]})}),(0,b.jsx)(d.PremiumTable,{columns:an,data:aq})]})]}),L&&(0,b.jsx)(q,{isOpen:N,onClose:()=>O(!1),item:L,userName:i}),V&&(0,b.jsx)(u,{isOpen:X,onClose:()=>{Y(!1),r.refresh()},request:V}),Z&&(0,b.jsx)(w,{isOpen:_,onClose:()=>{aa(!1),r.refresh()},request:Z,userName:i}),ab&&(0,b.jsx)(P,{isOpen:ad,onClose:()=>{ae(!1),r.refresh()},request:ab})]})]})}a.s(["WarehouseClient",()=>V],51206)}];

//# sourceMappingURL=src_app_%28dashboard%29_warehouse_WarehouseClient_tsx_b5cbc0b4._.js.map