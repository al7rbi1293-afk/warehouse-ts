module.exports=[93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},50645,a=>{a.n(a.i(27572))},43619,a=>{a.n(a.i(79962))},13718,a=>{a.n(a.i(85523))},18198,a=>{a.n(a.i(45518))},62212,a=>{a.n(a.i(66114))},70844,a=>{a.n(a.i(92359))},18035,a=>{"use strict";a.s(["DashboardClient",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call DashboardClient() from the server but DashboardClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/app/(dashboard)/dashboard/DashboardClient.tsx <module evaluation>","DashboardClient")},80375,a=>{"use strict";a.s(["DashboardClient",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call DashboardClient() from the server but DashboardClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/app/(dashboard)/dashboard/DashboardClient.tsx","DashboardClient")},40476,a=>{"use strict";a.i(18035);var b=a.i(80375);a.n(b)},44538,a=>{"use strict";var b=a.i(7997),c=a.i(20971),d=a.i(9307);a.i(70396);var e=a.i(73727),f=a.i(66518),g=a.i(40476);async function h(a){let b;if(a){let[c,d,e]=a.split("-").map(Number);b=new Date(c,d-1,e)}else b=new Date;b.setHours(0,0,0,0);let c=new Date(b.getTime()+864e5),d=`${b.getFullYear()}-${String(b.getMonth()+1).padStart(2,"0")}-${String(b.getDate()).padStart(2,"0")}`;try{let[a,e,g,h,i,j,k,l,m,n]=await Promise.all([f.prisma.worker.count({where:{status:"Active"}}),f.prisma.attendance.findMany({where:{date:{gte:b,lt:c}},include:{worker:{include:{shift:!0}}}}),f.prisma.request.count({where:{status:"Pending"}}),f.prisma.inventory.findMany({where:{qty:{lt:10}},orderBy:{qty:"asc"}}),f.prisma.worker.groupBy({by:["region"],where:{status:"Active"},_count:{id:!0}}),f.prisma.inventory.findMany({where:{location:"NSTC"},orderBy:{qty:"desc"},take:10}),f.prisma.attendance.count({where:{date:{gte:b,lt:c},status:"Absent"}}),f.prisma.attendance.count({where:{date:{gte:b,lt:c},status:"Vacation"}}),f.prisma.attendance.count({where:{date:{gte:b,lt:c},status:"Day Off"}}),f.prisma.attendance.count({where:{date:{gte:b,lt:c},status:"Sick Leave"}})]),o=e.filter(a=>a.worker?.shift?.name==="A1"),p=e.filter(a=>a.worker?.shift?.name==="B1"),q=o.filter(a=>"Present"===a.status).length,r=p.filter(a=>"Present"===a.status).length,s=new Date(b);s.setDate(s.getDate()-7);let t=await f.prisma.attendance.findMany({where:{status:"Present",date:{gte:s,lt:c}},select:{date:!0}}),u={};t.forEach(a=>{let b=a.date.toISOString().split("T")[0];u[b]=(u[b]||0)+1});let v=Object.entries(u).map(([a,b])=>({date:a,count:b})).sort((a,b)=>a.date.localeCompare(b.date)),w=e.filter(a=>"Present"===a.status).length,x=a>0?Math.round(w/a*1e3)/10:0;return{selectedDate:d,metrics:{activeWorkers:a,attendanceRate:x,presentCount:w,pendingRequests:g,lowStockCount:h.length,absentCount:k,vacationCount:l,dayOffCount:m,sickCount:n,a1Present:q,b1Present:r,a1Total:o.length,b1Total:p.length},lowStockItems:h.map(a=>({nameEn:a.nameEn,qty:a.qty,location:a.location})),workersByRegion:i.map(a=>({name:a.region||"Unknown",value:a._count.id})),topStockItems:j.map(a=>({name:a.nameEn,value:a.qty})),attendanceTrend:v,todayAttendance:e}}catch(a){return console.error("Dashboard data error:",a),{selectedDate:d,metrics:{activeWorkers:0,attendanceRate:0,presentCount:0,pendingRequests:0,lowStockCount:0,absentCount:0,vacationCount:0,dayOffCount:0,sickCount:0,a1Present:0,b1Present:0,a1Total:0,b1Total:0},lowStockItems:[],workersByRegion:[],topStockItems:[],attendanceTrend:[],todayAttendance:[]}}}async function i(a){let f=await a.searchParams,i=await (0,c.getServerSession)(d.authOptions);i&&i.user&&"manager"===i.user.role||(0,e.redirect)("/warehouse");let j=await h(f.date);return(0,b.jsx)(g.DashboardClient,{data:j})}a.s(["default",()=>i])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__6d3939e2._.js.map